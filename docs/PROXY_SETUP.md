# Настройка прокси для бота Massimo Dutti

## Исправление ошибки "net::ERR_NO_SUPPORTED_PROXIES"

При настройке прокси для мониторинга магазина Massimo Dutti может возникать ошибка `net::ERR_NO_SUPPORTED_PROXIES`. Данный документ объясняет, как правильно настроить прокси и избежать этой ошибки.

## Шаги для настройки прокси

### 1. Проверка соединения с прокси

Перед запуском основного бота рекомендуется проверить соединение с прокси:

```bash
node test-proxy.js
```

Этот скрипт запустит тестирование прокси и выведет результат. Если тест прошел успешно, вы увидите сообщение "Proxy test PASSED ✅" и скриншот успешного соединения будет сохранен в файле `proxy-test-result.png`.

### 2. Настройка файла конфигурации прокси

Прокси можно настроить двумя способами:

#### Вариант 1: Создание файла proxies.txt

Создайте файл `config/proxies.txt` и добавьте в него информацию о прокси в одном из следующих форматов:

```
# Формат ProxySeller (IP:PORT USERNAME:PASSWORD)
95.134.185.52:50100 sergey0rAy5:EHuowDxffu

# Стандартный формат (username:password@host:port)
sergey0rAy5:EHuowDxffu@95.134.185.52:50100

# Формат с явным указанием протокола
http://sergey0rAy5:EHuowDxffu@95.134.185.52:50100
socks5://sergey0rAy5:EHuowDxffu@95.134.185.52:50101
```

#### Вариант 2: Редактирование файла rotateProxy.js

Вы также можете напрямую отредактировать файл `src/utils/rotateProxy.js`, добавив свои прокси в массив `defaultProxies`:

```javascript
// Список прокси-серверов по умолчанию
const defaultProxies = [
  {
    protocol: 'http',
    host: '95.134.185.52',
    port: '50100',
    username: 'sergey0rAy5',
    password: 'EHuowDxffu'
  },
  // Добавьте дополнительные прокси здесь при необходимости
  {
    protocol: 'socks5',
    host: '95.134.185.52',
    port: '50101',
    username: 'sergey0rAy5',
    password: 'EHuowDxffu'
  }
];
```

### 3. Выбор правильного типа прокси

В зависимости от того, какой тип прокси вы используете, обратите внимание на следующие особенности:

#### HTTP прокси
- Используйте порт 50100 для HTTP прокси.
- Формат в файле конфигурации: `http://username:password@host:port`.

#### SOCKS5 прокси
- Используйте порт 50101 для SOCKS5 прокси.
- Формат в файле конфигурации: `socks5://username:password@host:port`.

### 4. Запуск приложения

После настройки прокси запустите приложение:

```bash
node src/index.js
```

### Устранение неполадок

Если вы продолжаете получать ошибку `net::ERR_NO_SUPPORTED_PROXIES`, попробуйте следующие шаги:

1. **Проверьте учетные данные**: Убедитесь, что имя пользователя и пароль прокси верны.

2. **Проверьте доступность прокси**: Используйте скрипт `test-proxy.js` для проверки соединения.

3. **Изменение протокола**: Если у вас есть доступ к обоим типам прокси (HTTP и SOCKS5), попробуйте переключиться с одного на другой.

4. **Перезапустите браузер**:
   ```bash
   pkill -f chromium
   node src/index.js
   ```

5. **Проверьте логи**: Изучите файлы логов в папке `logs` для получения подробной информации об ошибке.

6. **Измените аргументы запуска браузера**: В файле `src/services/browserService.js` вы можете изменить аргументы запуска браузера для лучшей совместимости с вашим прокси.

### Дополнительные ресурсы

- [Документация Puppeteer по работе с прокси](https://pptr.dev/guides/request-interception)
- [ProxySeller - Документация по настройке прокси](https://proxyseller.com/knowledge-base)

## Лог изменений

Последнее обновление: 23 апреля 2025 г.
- Улучшена поддержка SOCKS5 прокси
- Добавлен скрипт test-proxy.js для проверки соединения
- Исправлена ошибка "net::ERR_NO_SUPPORTED_PROXIES"
